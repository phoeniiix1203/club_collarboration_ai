<!DOCTYPE html>
<!--
Copyright 2018 Reiichiro Nakano All Rights Reserved.
Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at
http://www.apache.org/licenses/LICENSE-2.0
Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
==============================================================================
-->
<html lang="cn">

<head>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());
    gtag('config', 'UA-91864013-5');
  </script>

  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Galaxy2Painting</title>
  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.5.0/css/all.css"
    integrity="sha384-B4dIYHKNBt8Bc12p+WXckhzcICo0wtJAoU8YZTY5qE0Id1GSseTk6S+L3BlXeVIU" crossorigin="anonymous">

  <!-- Bootstrap core CSS -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.min.css" rel="stylesheet">
  <script src="dist/bundle.js"></script>
</head>

<style>
  .centered {
    margin: auto;
    display: block;
  }
</style>

<body>
  <div class="jumbotron jumbotron-fluid py-4" style="text-align: center; background-color: #f5f5f5;">
    <div class="container">
      <h4>Galaxy2Painting</h1>
    </div>
  </div>
  <div>
    <div id="mobile-warning" hidden class="alert alert-warning" role="alert">
      <!-- This site may have problems functioning on mobile devices.
      Don't worry, you can still read the description below! -->
      这个网页可能在移动设备上有一些问题。别担心，你还是可以阅读这些有趣的知识。
    </div>
    <ul class="nav nav-tabs nav-fill" id="myTab" role="tablist">
      <li class="nav-item">
        <a class="nav-link active" id="stylize-tab" data-toggle="tab" href="#stylize" role="tab" aria-controls="stylize"
          aria-selected="true">生成图片</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" id="faq-tab" data-toggle="tab" href="#faq" role="tab" aria-controls="faq"
          aria-selected="false">FAQ</a>
      </li>
    </ul>
    <div class="tab-content" id="myTabContent">
      <div class="tab-pane fade show active" id="stylize" role="tabpanel" aria-labelledby="stylize-tab">
        <div class="container">
          <div class="row my-4">
            <div class="col mx-5 my-4">
              <img id="content-img" class="centered" src="images/example.jpg" height=256></img>
              <br>
              <label for="content-img-size">图片大小</label>
              <i class="far fa-question-circle" data-toggle="tooltip" data-placement="top"
                title="更大的图片会提升输出图片的细节，但也会增加运算强度和运算时间"></i>
              <input type="range" min="256" max="400" value="256" class="custom-range centered" id="content-img-size">
              <br>
              <select id="content-select" class="centered custom-select">
                <option value="example" selected="selected">默认</option>
                <option value="file">上传图片</option>
              </select>
            </div>
            <div class="col mx-5 my-4">
              <img id="style-img" class="centered" crossorigin="anonymous" src="images/sketch.jpg" height=256></img>
              <br>
              <label for="style-img-size">生成图片</label>
              <i class="far fa-question-circle" data-toggle="tooltip" data-placement="top"
                title='修改图片的大小会直接影响生成图像的质感'></i>
              <input id="style-img-square" type="checkbox" style="vertical-align: middle; float: right;"
                data-toggle="tooltip" data-placement="top" hidden=True>
              <input type="range" min="100" max="400" value="256" class="custom-range centered" id="style-img-size">
              <br>
              <select id="style-select" class="centered custom-select">
                <option value="sketch" selected="selected">素描</option>
                <option value="surrealism">超现实主义</option>
                <option value="crayon_drawing">蜡笔画</option>
                <option value="black_and_white">黑白画</option>
                <option value="random">从wikiart.org随机选择一个风格</option>
                <option value="file">上传图片</option>
              </select>
            </div>
          </div>

          <div class="row my-4">
            <div class="col-md-6 offset-md-3">
              <canvas id="stylized" class="centered"></canvas>
              <br>
              <label for="stylized-img-ratio">渲染强度</label>
              <input type="range" min="0" max="100" value="100" class="custom-range centered" id="stylized-img-ratio">
            </div>
          </div>
          <div class="row my-4">
            <div class="col-md-5 offset-md-3">
              <button disabled id="style-button" type="button" class="btn btn-primary btn-block">正在渲染图片，请稍等......</button>
            </div>
            <div class="col-md-1">
              <button type="button" id="randomize" class="btn btn-light btn-block">
                <i class="fas fa-random" data-toggle="tooltip" data-placement="top" title="Randomize parameters"></i>
              </button>
            </div>
          </div>
        </div>
      </div>
      <!--  -->

      <div class="tab-pane fade" id="faq" role="tabpanel" aria-labelledby="faq-tab">
        <div class="container-fluid pt-5">
          <h5>
            这是一个什么网页？
          </h5>
          <p>
            本网页改编自<a
            href="https://github.com/reiinakano/arbitrary-image-stylization-tfjs/blob/master/index.html">
            arbitrary-image-stylization-tfjs</a>是一个利用ai技术将图片转换成不同风格的网页。
          </p>
          <p>
            项目优势：
            该项目可以实现任意风格的选择以及转换。其底层原理是运用了两个神经网络，一个是用于提取图片的特征，另一个是用于将特征转换成不同风格的图片。从而实现了任意风格的转换。而之前的传统的相同类型的项目，只能实现固定的风格的转换。仅能实现单一风格迁移。
            <!-- Conventional style transfer solutions usually normally limited to a pre-selected handful of styles. In this
            project, two neural networks are used to provide infinitely many styles. -->
          </p>
          <p>
            实现原理：
            首先，一个 <i>风格学习器</i> 先将 <b>任意</b> 的选定的图片进行处理并生成一个
            相对应的100维的向量。 该向量也被称为风格向量，主要用于记录这种风格的一些具体细节。例如，如果是素描风格，那么风格向量就会记录下铅笔的质感。
            随后，该向量会作为参数传入到 <i>风格迁移器中</i>。此时，如果向风格迁移器中传入图片，那么风格迁移器就会将图片的原有的特征替换成风格向量所记录的风格。通过更改不同的风格向量，我们可以实现不同的种类风格的迁移。
            
          </p>
          <h5>
            我所上传的图片会被保存吗？
            <!-- Is my data safe? Can you see my pictures? -->
          </h5>
          <p>
            不会。该项目的所有关于图像的运算仅在<b>本地</b>进行。
          </p>
          <h5>
            <!-- How big are the models downloaded? -->
            运行这个模型会占用我很多电脑空间吗？
          </h5>
          <p>
            完全不会。这个优化过的神经网络模型只有 12MB 大小，且仅需要下载一次。
          </p>
          <h5>
            <!-- The image produced seems blurred/ugly/unsatisfactory? -->
            生成的图片看起来模糊不清？不好看？不尽人意？
          </h5>
          <p>
            请理解神经网络可能存在的局限性。你可以尝试一下调整图片的大小以及渲染的强度，毕竟ai本来就是一个“炼丹”的过程。

            <!-- Try again with different style image size and stylization strength. You can also use the "randomize
            parameters"
            button! -->
          </p>
        </div>
      </div>
      <div id="model-select-style" value="mobilenet"></div>
      <div id="model-select-transformer" value="selected"></div>

      <div class="modal fade" id="cam-modal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
        aria-hidden="true">
        <div class="modal-dialog modal-lg" role="document">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title" id="exampleModalLabel">拍张图片！</h5>
              <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                <span aria-hidden="true">&times;</span>
              </button>
            </div>
            <div class="modal-body">
              <video id="webcam-video" class="centered" width="500" height="375"></video>
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-secondary" data-dismiss="modal">取消</button>
              <button type="button" class="btn btn-primary" id="snap-button">茄子！</button>
            </div>
          </div>
        </div>
      </div>

      <script>
        function changeLang() {
          window.location.href = "index.html"
        }
      </script>
      <div align="center">
        <button type="button" class="btn btn-secondary" onclick="changeLang()"
          style="text-align:center;"><b>CN</b>/EN</button>
      </div>
      <!-- JQuery -->
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.1/jquery.min.js"></script>
      <!-- Bootstrap tooltips -->
      <script type="text/javascript"
        src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.4/umd/popper.min.js"></script>
      <!-- Bootstrap core JavaScript -->
      <script type="text/javascript"
        src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/js/bootstrap.min.js"></script>

      <script type="text/javascript">
        $(function () {
          $('[data-toggle="tooltip"]').tooltip()
        })
      </script>
</body>

</html>